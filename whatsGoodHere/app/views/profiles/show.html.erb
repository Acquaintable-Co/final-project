<div class="app-container profile">
    <div class="top-nav-bar">
        <div>
          <%= link_to "wgh", profiles_path, class: "app-initials" %><span class="nav-q-mark">?</span>
        </div>
        
        <div class="new-search-icon"><i class="fa fa-search"></i></div>
    </div>

    <div class="top-info">
        <div class="name-field">
            <h1 class="business-name">
            <%= @profile.restaurant %></h1>
                <% if flash[:error_message] %>
                <p class="flash-error"><%= flash[:error_message] %></p>
                <% end %>
        </div>  

        <div class="address-phone"><%= @profile.address %>  |  <%= @profile.phone %>
        </div>    

        <div class="hours"> <%= @profile.hours %> </div>
    </div>

    <div class="info-section">
        <div class="info-category-header fare">fare</div>

            <div class="menu-icon"><button>
            <i class="fas fa-utensils"></i>
            <p>see menu</p></button>
            </div>

        <a class="expand-link" onClick=showDetail('fare-detail')>see more</a>
        
        <% @profile.offers.each do |offer| %>

        <div class="hidden fare-detail info-entry"> 
        
            <%= offer.offer_detail %>
            <% if current_profile && @profile.id == current_profile.id %>
            <div class="item-delete">
                <%= link_to 'delete', offer_path(offer), method: :delete %> 
            </div>
            <% end %>
            <% end %>

        <% if current_profile && @profile.id == current_profile.id %>
            <%= form_with model: @offer, url: offers_path, local: true do |f| %>
        
            <%= f.text_field :offer_detail, class: 'input is-small add-new-item', placeholder: "enter new Fare entry here" %> 
            <a class="button save-entry is-small" >
            <%= f.submit %> </a>
        <% end %>
        <% end %>     
    </div>            

    <div class="info-section">
        <div class="info-category-header tips">tips</div>

        <a class="expand-link" onClick=showDetail('tips-detail')>see more</a>
        <% @profile.hacks.each do |hack| %>
            <div class="hidden tips-detail info-entry"> <%= hack.hack_detail %> </div>
                <% if current_profile && @profile.id == current_profile.id %>

                <div class="item-delete">
                <%= link_to 'delete', hack_path(hack), method: :delete %>
                </div>

                <% end %>
                <% end %>

        <% if current_profile && @profile.id == current_profile.id %>
        <%= form_with model: @hack, url: hacks_path, local: true do |f| %>
    
        <%= f.text_field :hack_detail, class: 'input is-small add-new-item', placeholder: "enter new Tips entry here" %>

        <a class="button save-entry is-small" >
        <%= f.submit %> </a>
        <% end %>
        <% end %>
    </div>     

    <div class="info-section">
        <div class="info-category-header specs">specs</div>

        <a class="expand-link" onClick=showDetail('specs-detail')>see more</a>
        <% @profile.locations.each do |location| %>
            <div class="hidden specs-detail info-entry"> <%= location.location_detail %> </div>
            <% if current_profile && @profile.id == current_profile.id %>

            <div class="item-delete">
            <%= link_to 'delete', location_path(location), method: :delete %>
            </div>

            <%end %>
            <% end %>

        <div class="add-new-item">
        <div class="field">
            <div class="control">

            <% if current_profile && @profile.id == current_profile.id %>
            <%= form_with model: @location, url: locations_path, local: true do |f| %>
        
            <%= f.text_field :location_detail, class: 'input is-small add-new-item', placeholder: "enter new Specs entry here" %>
            
            <a class="button save-entry is-small" >
            <%= f.submit %> </a>
                <% end %>
                <% end %>
            </div>    
            </div>    
            </div>    
    </div>
    
<% if current_profile && @profile.id == current_profile.id %>
<%= form_with model: @profile, local: true do |form| %>

  <%= form.label "Upload a Menu" %>
  <%= form.file_field :menu, class: "button upload-button"%>

  <%= form.label "Upload a 360 image" %>
  <%= form.file_field :vr_image, class: "button upload-button" %>

  <%= form.label "Upload Floor Plan" %>
  <%= form.file_field :floor_plan, class: "button upload-button"%>

  <%= form.submit "submit", class: "button upload-button" %>
<% end %>
<% end %>

  <% if @profile.menu.attached? %>
    <%= link_to "View Menu", rails_blob_path(@profile.menu, disposition: "menu"), target: "_new" %>
  <% end %>

  <% if @profile.floor_plan.attached? %>
    <%= link_to "View Floor Plan", rails_blob_path(@profile.floor_plan, disposition: "floor_plan"), target: "_new" %>
  <% end %>
  
  <% if @profile.vr_image.attached? %>
  <div id="myEmbeddedScene">
 
  <a-scene embedded="">
   <a-sky src="<%= url_for(@profile.vr_image) %>"></a-sky>
  </a-scene>
  </div>
  <% end %>


    <% if current_profile %>  
    <%= link_to "log out of administator view", logout_path, method: :delete, class:"button is-fullwidth admin-log-out" %>
    <% end %></a>

</div>   
