<div class="app-container profile">
    <div class="top-nav-bar">
        <div>
          <%= link_to "wgh", profiles_path, class: "app-initials" %><span class="nav-q-mark">?</span>
        </div>
        
        <div class="new-search-icon"><i class="fa fa-search"></i></div>
    </div>

    <div class="top-info">
        <div class="name-field">
            <h1 class="business-name">
            <%= @profile.restaurant %></h1>
                <% if flash[:error_message] %>
                <p class="flash-error"><%= flash[:error_message] %></p>
                <% end %>
        </div>  

        <div class="address-phone"><%= @profile.address %>  |  <%= @profile.phone %>
        </div>    

        <div class="hours"> <%= @profile.hours %> </div>
    </div>

    <% if current_profile && @profile.id == current_profile.id %>
    <%= form_with model: @profile, local: true do |form| %>


    <%= form.label "Upload or replace a Menu", class: "upload-file-label", type: "text" %>
    <%= form.file_field :menu %>

    <%= form.label "Upload or replace a 360 image", class: "upload-file-label", type:"text"  %>
    <%= form.file_field :vr_image %>

    <%= form.label "Upload or replace a Floor Plan", class: "upload-file-label", type:"text"  %>
    <%= form.file_field :floor_plan %>

    <%= form.submit "submit", class: "button  upload-button" %>
    <% end %>
    <% end %>

    <% if @profile.vr_image.attached? %>
    <div id="myEmbeddedScene">
        
        <a-scene embedded="">
        <a-sky src="<%= url_for(@profile.vr_image) %>"></a-sky>
        </a-scene>
    </div>
    <% end %>

<div class="info-section-container">

    <div class="info-section">

        <div class="info-category-header fare">fare</div>

        <div class="view-icon">
            <% if @profile.menu.attached? %>
            <%= link_to "<i class='fas fa-utensils'></i><div class='view-caption'> view menu</div>".html_safe, rails_blob_path(@profile.menu, disposition: "menu"), target: "_new" %>
            <% end %> 
        </div>

        <a class="expand-link" onClick=showDetail('fare-detail')> ... see more</a>
        
        <% @profile.offers.each do |offer| %>

        <div class="hidden fare-detail info-entry"> •   

            <%= offer.offer_detail %> 
            <% if current_profile && @profile.id == current_profile.id %>
            
            <span class="item-delete">
                <%= link_to 'delete', offer_path(offer), method: :delete %> 
            </span> 

            <% end %>
        </div>
            <% end %>    

            <% if current_profile && @profile.id == current_profile.id %>
            <%= form_with model: @offer, url: offers_path, local: true do |f| %>
        
            <%= f.text_field :offer_detail, class: 'input add-new-item', type: "text", placeholder: 'enter new "fare" item here' %> 
            <a class="button save-entry" >
            <%= f.submit %> </a>
            <% end %>
            <% end %>                    

        <div class="info-category-header tips">tips</div>

        <a class="expand-link" onClick=showDetail('tips-detail')> ... see more</a>

        <% @profile.hacks.each do |hack| %>
        
        <div class="hidden tips-detail info-entry"> •
            <%= hack.hack_detail %> 

            <% if current_profile && @profile.id == current_profile.id %>

            <span class="item-delete">
            <%= link_to 'delete', hack_path(hack), method: :delete %>
            </span>

            <% end %>
        </div>
            <% end %>    


            <% if current_profile && @profile.id == current_profile.id %>
            <%= form_with model: @hack, url: hacks_path, local: true do |f| %>
        
            <%= f.text_field :hack_detail, class: 'input add-new-item', placeholder: 'enter new "tips" item here', type: "text" %>

            <a class="button save-entry" >
            <%= f.submit %> </a>
            <% end %>
            <% end %>
            

        <div class="info-category-header specs">specs</div>

            <div class="view-icon">
                <% if @profile.floor_plan.attached? %>
                <%= link_to "<i class='fas fa-map'></i> <br> 
                view floor plan".html_safe, rails_blob_path(@profile.floor_plan, disposition: "floor plan"), target: "_new", class: "view-caption" %>
                <% end %>                
            </div>

            <a class="expand-link" onClick=showDetail('specs-detail')> ... see more</a>

            <% @profile.locations.each do |location| %>

            <div class="hidden specs-detail info-entry"> • 
            <%= location.location_detail %> 

            <% if current_profile && @profile.id == current_profile.id %>

            <span class="item-delete">
            <%= link_to 'delete', location_path(location), method: :delete %>
            </span> 

            <% end %>
        </div>
            <% end %>    

            <% if current_profile && @profile.id == current_profile.id %>
            <%= form_with model: @location, url: locations_path, local: true do |f| %>
        
            <%= f.text_field :location_detail, class: 'input add-new-item', placeholder: 'enter new "specs" item here', type: "text" %>
            
            <a class="button save-entry" >
            <%= f.submit %> </a>
                <% end %>
                <% end %>   
    </div>          
</div>

    <% if current_profile %>  
    <%= link_to "log out of admin view", logout_path, method: :delete, class:"button is-fullwidth admin-log-out" %>
    <% end %></a>

</div>   
